DevOps - OverView
====

# 배경
* 산업이 바뀌면서 비즈니스 자체를 소프트웨어가 대체하는 경우가 많아짐.
* 장시간에 걸쳐 완벽한 소프트웨어를 만드는 것 보다 TTM(Time To Market, 제품을 만들어 시장에 내놓는데 까지 걸리는 시간)이 우선시되는 경우가 많아짐.
* 스타트업의 최대 리스크는 **아무도 필요로 하지 않는 것**을 만드는 것이다.
    * MVP 먼저 만들어보고 그에 대한 사용자의 피드백을 받아가며 방향을 결정하자.

## Agile 개발 방식이 적합한 경우
* 요구가 올바른지 평가해보지 않으면 알 수 없는 제품
* 요구가 도중에 변화할 가능성이 있는 제품

## 개발/운영이 모두 짧은 주기로 이루어져야 하는 상황
* 운영 환경 구축, 소프트웨어 배포, 장애 시 대응 등... Ops팀도 변화를 빠르게 적용시켜야 한다.
* 빠르게 변화시키려는  Dev vs 안정적으로 운용하고픈 OPs

# DevOps
개발자(Dev)와 운영자(Ops)가 상호 협력해가면서 비즈니스의 가치를 실현하는 개념 (방법론이 아님)
* DevOps를 구성하는 요소 : CLAMS (Culture, Lean, Automation, Measurement, Sharing)

## 개발자와 운영자가 집중해야 하는 것
### 조직의 문화
1. 상호 존중 (Respect)
2. 상호 신뢰 (Trust)
3. 실패에 대한 건전한 태도 (Healthy attitude about failure)
4. 상대를 비난하지 않기 (Avoiding Blame)

### 도구
1. 자동화된 인프라 (Automated Infrastructure)
2. 버전 관리 시스템의 공유 (Shared version control)
3. 원스텝 빌드와 배포 (One step build and deploy)
4. 피처 플래그 (Feature flags)
5. 지표 데이터의 공유 (Shared metrics)
6. IRC와 인스턴트 메신저 봇 (IRC and IM robots)

## 조직에 DevOps 적용하기
* 새로운 것을 도입할 때 가장 먼저 생각해야 할 것 
    * "도대체 지금 무엇 때문에 어려움을 겪고 있는가?"
    * "지금 해결해야 할 과제는 무엇인가?"
* 방법/도구는 솔루션 중 하나일 뿐. 방법/도구의 도입 자체가 목적이 되면 안됨!

## 도구 도입하기
### 방법
* 도입 이유를 명확히 한다.
* 도구는 사실상 표준인 것을 선택한다.
* 한 번에 많은 도구를 도입하지 말고 서서히 도입하며 교육/정착에 신경쓰자.
* 유지보수는 스스로 한다.

### 순서
![](./images/도구도입과정.png)
* 버전 관리 시스템 -> 프로젝트 관리 도구 -> 테스트 자동화 -> 지속적 통합 도구 -> 가상 환경 구축 도구 -> 프로비저닝 도구 -> 모니터링 도구

### 팁
* 빌드 실패 시 Fix 코드 이외에는 커밋하지 않는다는 룰을 지키면 항상 품질을 담보할 수 있다.
* 모니터링 도구 도입 시, 무엇을 위해 해당 지표 데이터를 모니터링 하는지 사전에 정해야 한다.

# Infrastructure as Code
수작업으로 해오던 인프라 구축이나 변경 작업을 코드로 작성해서 자동화하는 것.

자동화 된 인프라를 실현하기 위한 방법 중 하나.

## 주의사항
1. 사전에 요구사항을 정리할 것
2. 갑자기 모든 것을 자동화하려 하지 말 것
3. 현재의 팀 스킬도 고려해서 도구를 선택할 것
4. 자동화 코드는 항상 지속해서 테스트 할 것. 자동화 코드의 실행에 실패한 경우에는 그 다음 작업을 수작업으로 속행하지 말 것
5. 이러한 사항들을 팀 구성원에게 철저하게 주지시킬 것

## Immutable Infrastructure (불변 인프라)
일단 서버를 구축했으면 그 후에는 서버의 소프트웨어에 변경을 가하지 않는 것.
즉, 변경이 필요할 경우 기존 서버에 변경을 가하지 않고 새로운 서버를 만들어 기존 서버를 모두 대체하는 방식.

대표적으로 **컨테이너 기술**이 그러하다. (ex) Docker)

### 장점
* 모든 서버가 같은 상태라는 것이 보장된다.
* 멱등성[^1]에 관해 다양하게 고려해야 할 필요성에서 벗어나므로 자동화 코드가 간소해진다.
* 자동화 코드의 유지보수도 쉬워진다
* 새로운 서버를 배포할 때 로드밸런서나 리버스 프록시 설정 변경을 통해서 하기 때문에 롤백하기가 쉽다.

[^1]: Idempotency. 여러번 적용해도 결과는 바뀌지 않는 것. 수정사항이 없으면 배포되어도 바뀌지 않는다. 수정된 부분이 있으면 그 부분만 배포된다.

### 주의사항
* 서버를 자주 만들게 되므로 구축 부분/테스트가 자동화 되어있어야 한다.
* 서버를 다시 만들기 때문에 영구적인 데이터는 저장할 수 없다. (DB, File Storage에는 이 기술을 적용할 수 없다)
* Stateless 한 설계가 필요하다.

